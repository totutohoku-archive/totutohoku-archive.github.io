<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
<meta charset="UTF-8">
<META name="GENERATOR" content="IBM HomePage Builder 2001 V5.0.0 for Windows">
<TITLE>システマティック麻雀工学</TITLE>
</HEAD>
<BODY background="1052.gif" alink="#ff7f00" bgcolor="#e0e0e0" link="#ff0000" text="#000000" vlink="#400080">
<P>システマティック麻雀工学：<FONT size="+3"><B><BR>
１：他家必要メンツのモデル化理論と実装（MJ-0ルーチン）</B></FONT><BR>
<BR>
<BR>
<A href="http://www.amazon.co.jp/exec/obidos/ASIN/4061497650/sml-22"><IMG src="kagakusuru.jpg" width="72" height="120" border="0"></A><FONT color="#FF0000"><SCRIPT type="text/javascript"><!--
google_ad_client = "pub-0849366231331886";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_type = "text_image";
google_ad_channel ="";
//--></SCRIPT> <SCRIPT type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</SCRIPT> <BR>
</FONT><BR>
人間の読みと少なくとも同等か、それ以上に精確でしかも高速な「他家の構成メンツ読み（必要牌読み）」プログラムを作る。<BR>
<BR>
<B><FONT size="+1">他家必要メンツモデルの着想：</FONT></B><BR>
<BR>
麻雀における重要な技術要素として主要なものは、「メンツ構成」「降り」「点数別行動選択」などが挙げられるが、局単位で考えたときに非常に重要になるのは「どの牌を引く可能性が高いか」「相手の待ちはどれになるか」などの判断である。この判断の差は和了率・放銃率いずれにも大きな差を与え、局単位のゲームとして麻雀を見た時の技術要素の大部分を占めていると言っても良い（降りる技術のほとんどと、上がる技術の一部を占める）。<BR>
例えば２が３枚切れており、誰もトイトイを狙っていないとき、１は場に出やすいし、場に出ていなければツモりやすい。そして、他家リーチに対して１が通る確率は他の無スジに比較して高くなる。<BR>
しかしこの種の判断はこれまでほとんど全てが小学生レベルの経験からの判断と、中学生レベルの簡単な計算と、それからいい大人の妄想によってしか語られてこなかった。<BR>
それというのも麻雀の他家の挙動は数値化が困難で、また牌の構成を解析的あるいは統計的に解くことは非常に莫大な計算を要するからである。結果として、印象に異常に左右される経験や、そこから導かれる妄想が、その判断の全てになってしまっていた。<BR>
ところが我々は思い起こしてみよう。ほとんどどんな状況であっても、リーチに対して地獄待ちの西を切ることは、無スジの５を切ることより安全なのである。これは全ての上級者にとって当然の認識であり、背景に統計的な洞察があるにもかかわらず、このような単純な状況を離れて複雑になると全て「状況による」としか答えられない打ち手の姿がそこにあった。<BR>
複雑化された場合にも「状況による」として漠然とした直感に逃げて上級者ぶるのはやめて、「リーチに対して地獄待ちの西を切ることは、無スジの５を切ることより安全」と自信を持って言い切れたように、「このリーチに対してこの牌を切ることはこの牌を切ることよりもこの程度安全だ」と断言できるための工学を作ろうと思う。<BR>
背景は「地獄待ちの西は安全」であった根拠であるところの「牌の組み合わせ（統計学的アプローチ）」である。<BR>
<BR>
<BR>
<B><FONT size="+1">他家必要メンツモデルの概要：</FONT></B><BR>
<BR>
「どのメンツ（牌）が何枚、他家にとって必要となるか」ということをモデル化しよう。<BR>
そうすれば、どの牌が山にどの程度残っているかということが計算できるだろう。他家にとって必要でない牌（不要牌）は通常切られるため、場に出ている枚数と他家が必要とする枚数を除いた枚数が、山に残っている枚数に近い値を示すからである。<BR>
また、他家が必要とする牌のうちの１つ（とそのスジや別の待ちコウツなど）は「当たり牌」だから、他家の必要牌を求めることは、他家の待ちを求めるために有益である。<BR>
このモデルがもし現実の状況を的確に捉えるようになれば、最初に述べた「局単位のゲームとして麻雀を見た時の技術要素の大部分を占めている」ような判断を、このモデルを元に的確に行うことができるはずである。<BR>
<BR>
では他家が必要とする牌の性質について考える。<BR>
<B>１）単純に牌を組み合わせた時の必要牌</B><BR>
「牌空間」を、既に切られた牌や既に他家のメンツに使用されていない全ての牌の組み合わせとする。<BR>
他家がテンパイを目指すとき、４メンツと１頭が構成される（チートイは例外）。<BR>
牌空間内からの単純な組み合わせのみでメンツを構成するとき、あるメンツ構成を他家がテンパイのために利用する確率は、そのメンツを構成できる牌の組み合わせの多さ（メンツの作りやすさ）に比例する。<BR>
（機械が適当に牌を３枚選んでメンツを作るとき、111より123の方ができやすい。また、2が3枚切れという条件付きの牌空間内でなら、123より456の方ができやすい）<BR>
<B>２）役を考慮する</B><BR>
・染め手を考慮する<BR>
もしある他家が染め手であれば、その他家にとっての必要牌は、機械的な組み合わせの場合と比べて大きく変化する。したがって特定の他家が染め手である確率のパラメータを導入し、染め手であるときにはその他家にとっての牌空間を変更する。<BR>
・トイトイを考慮する<BR>
もしある他家がトイトイであれば、他家のメンツ構成においてシュンツは構成しないこととする。特定他家トイトイ率のパラメータを導入する。<BR>
・食い仕掛けを考慮する<BR>
もしある他家がポンやチーを交えることができるならば、他家のメンツ構成においてメンゼンの場合に比較してコウツが構成される割合が増加する。ポンを交えることができる場合、コウツの構成率は４人分の牌を利用するから４倍になり、チーができる場合にはそのシュンツ構成率は２倍になる。特定の他家が食い仕掛けをする確率をパラメータとして導入する。<BR>
また、食い仕掛けが入り、かつ染め手でない場合、少なくとも１つのメンツが役牌によって構成される確率は非常に高まる。クイタンや三色やケイテンの可能性もあるので、詳細のパラメータは後に取るとして、もし食い仕掛けが入りかつ役牌がコウツを形成する場合、その影響をモデルに導入する必要がある。ただしこれは現段階ではモデルに含まない。<BR>
・その他<BR>
基本的には三色やタンヤオ移行などによる補正は入れない。そのために牌効率を大きく犠牲にする打ち方は「強くない」ことが知られているし、そもそも三色に移行することを考えるような組み合わせ自体がまれだから影響が小さい。<BR>
<BR>
<BR>
<B><FONT size="+1">他家必要メンツモデルの実装（MJ-0ルーチン）：</FONT></B><BR>
<BR>
他家が必要とする牌の性質を、上記２点の性質を考慮しながらモデル化する。<BR>
<B>１）初期化</B><BR>
全ての他家のメンツ（およびシュンツ、コウツ、食いシュンツ、食いコウツ、頭）を「非固定」にセット。<BR>
一般的な牌空間として、「牌全部－自分から見えている牌」をセットする。<BR>
この段階でもしあるメンツが他家に存在することがわかっている場合（ポンなど）、それにしたがって牌空間を変更し、そのメンツは「固定」する。<BR>
他家の染め手率やトイトイ率などに応じて他家を「染め手している人」「トイトイしている人」などかどうかを決定し、役を狙っている場合、それに応じてその当人から見た牌空間補正をセットする（例えばマンズ染めの人は、牌空間としてピンズとソーズを持たない）。<BR>
<B>２）実際に１つメンツを構成する</B><BR>
当人の牌空間の中から、メンツ構成比率にしたがってメンツを１つ「固定」する。固定されたメンツを構成する牌は全員の牌空間から除去される。<BR>
<B>３）繰り返し</B><BR>
２を、12個（３人×４メンツ）のメンツが「固定」されるまで繰り返す。<BR>
<B>４）頭を構成する</B><BR>
各他家の頭を構成する。頭の構成のしやすさ（牌空間上の組み合わせの個数比）に応じて頭の位置を固定する。<BR>
ただし、メンゼンシュンツが存在するとき、「スジ型」の頭も構成し得るのでそれも考慮する（456とシュンツがあるとき、36や47の組み合わせも頭を構成する）。<BR>
<BR>
以上のモデルをコンピュータ上でシミュレートすることによって、「ある状況における他家の構成メンツの一例」を求めることができる。<BR>
これを充分な回数繰り返せば（例えば5000回・・・時間にして0.2秒未満）、「ある状況における他家の構成メンツの確率分布」を知ることができる。<BR>
これを行うためのプログラムを以下、「MJ-0」と呼ぶ。<BR>
<BR>
<BR>
<B><FONT size="+1">簡単な、モデルの評価例：</FONT></B><BR>
<BR>
このモデルが、実際の麻雀における他家の必要牌を表しているかどうかを検証する。<BR>
方法は、「牌山の推測」を用いる。<BR>
<BR>
手順<BR>
１）MJ-0による推測<BR>
あるプレイヤーから見た「状況」を、MJ-0に与える。自分の牌、捨て牌および他家の使用する牌を除いた牌が等確率で牌山にあると推測できる。<BR>
牌山に残った牌の分布は確率的に表せるので、最も残っている確率が高い２牌と、その次に残っている確率の高い５牌を選ぶ。<BR>
<BR>
２）人間による推測<BR>
シスマの技術員やアンチシスマメンバーなど、超ラン常勝組メンバーを含む比較的ハイレベルな打ち手に、同様の状況で牌山に「確実に残っているだろう牌」を２牌、「たぶん残っているだろう牌」を、残っている枚数がなるべく多いように５牌指定してもらった。<BR>
参加者：バイマンキン　ＢＪ　難波-男児　モ娘。なっち　散る桜ゆえ　雀鬼百瀬　疾駆★白馬＆みずか　激弱なんし　<BR>
　　　　　神龍★悪魔　しれん　少年Ｎ　まんぼう　ＢＯＮＹ　WAve-Model　ゆうば　<BR>
<BR>
３）実際の状況の設定<BR>
とつげき東北の実戦の牌譜から、適当に状況を取り出す。<BR>
山牌が読みによって読まれるようにするため、終順近くで、１家から食い仕掛けが入り、それ以外の家は特に食い仕掛けなどを行っておらず、他家が特にベタオリしていなさそうな一般的な状況を牌譜から適当に取り出し、３つ設定した。<BR>
<BR>
４）推測精度の比較<BR>
MJ-0の予測と人間の推測の精度を各々評価する。<BR>
予想した牌が実際に山に残っていた枚数を点数とする。また予想したにもかかわらず残っていなかった場合は１点減点とする。<BR>
重要な２牌については加点および減点を２倍する。<BR>
<BR>
参加者名　　　Ａ　　Ｂ　　　Ｃ　　Ｄ　　　Ｅ　　Ｆ　　　Ｇ　　Ｈ　　　　Ｉ　　　Ｊ　　Ｋ　　　Ｌ　　Ｍ　　　Ｎ　　Ｏ　　Ｐ　　　　　　　　<B>MJ-0</B><BR>
問１得点　　　12　　10　　12　　13　　10　　14　　　9　　　9　　10　
　10　　11　　12　　12　　16　　9　　 12　　　　　　　　12<BR>
問２得点　　　13　　17　　10　　14　　19　　11　　13　　　　　　　8　　14　　17　　15　　13　　14　　10　　13　　　　　　　　16<BR>
問３得点　　　11　　15　　17　　15　　17　　14　　22　　　　　　11　
　14　　17　　15　　20　　10　　11　　13　　　　　　　　22<BR>
得点合計　　　36　 42　　39　　42　　46　　39　　44　　　　　　29　
　38　　45　　42　　45　　40　　30　　37　　　　　　　　50<BR>
誤答減点　　　-3　 -2　　-4　　-4　　-2　　-4　　-5　　-2
　　-7　 　-2　　-2　　-4　 　-2　　-1　
-5　　-5　　　　　　　　-2<BR>
<B>最終得点　　33　 40　 35　 38　 44　　35　
39　　 　　　22　 36 　43　　38　 43　 39　
25　 35　　　　　　　48</B><BR>
<BR>
<FONT size="+1"><B>結果</B></FONT>（追検証のために名前と点数の対応は非公開としました。Ｈさんはデータ不足により除外して集計）<BR>
スコア　名前<BR>
<B>48</B>　　　<B>MJ-0（上記モデルにしたがって牌を読むコンピュータ）</B><BR>
44　　　Ｅ<BR>
43　　　Ｍ<BR>
43　　　Ｋ<BR>
40　　　Ｂ&nbsp;&nbsp; <BR>
39　　　Ｎ<BR>
39　　　Ｇ<BR>
38　　　Ｌ<BR>
38　　　Ｄ<BR>
36　　　Ｊ<BR>
35　　　Ｐ<BR>
35　　　Ｆ<BR>
35　　　Ｃ<BR>
33　　　Ａ<BR>
25　　　Ｏ<BR>
22　　　Ｉ<BR>
<BR>
人間平均：MJ-0　＝　36：48<BR>
<BR>
５）考察<BR>
もちろん、より多いデータに基づいて検証できれば良いが、時間等の事情でここでは割愛する。より詳しいモデル検証は機会があれば別に行う。<BR>
<A href="mjcom_B0.html"><B><FONT color="#0000FF">追試結果はこちら</FONT></B></A><BR>
<BR>
<B>人間は点数の状況や、他の様々な状況（早い順目の８切りなど）を考慮することができ、MJ-0はそれらを全く考慮していないにもかかわらず、また現段階ではドラなどの有効性や役牌の選択など一切考慮していないにもかかわらず、MJ-0の「余り牌読み」能力はここに回答した人間の中でトップであり、下位とは特に大きな差がついた。１局あたりで、平均と比較して４枚近くも多い残り牌を指定できた（人間のうち上位３人だけの平均に対しても、平均1.5枚以上も多い残り牌を指定できた）。また総合得点だけでなく、正答率の高さ・誤答率の低さいずれにおいてもトップレベルの成績であった。どの人間に対しても、３つの状況のうち少なくとも２状況で高い点を記録した。</B><BR>
わずか３例とは言え、この結果を見る限り、多くの一般的な状況においてMJ-0ルーチンは、人間と同等程度（あるいはそれ以上）の結果を出すことが期待できる。<BR>
<BR>
このことは、上記モデルが「他家が必要とするメンツのモデル」として充分よく機能していることを示している。<BR>
<B>麻雀界において初めて「出やすい牌（待ち）はどれですか？」「次にツモる確率が最も高い牌は何ですか？」という問に対して、超ランの平均レベルよりかなり高い精度の、明快な理論的解答を示すことができるようになった。</B><BR>
また第一東風荘超ランで優秀な成績を収めている人たちの「色々な状況を加味した読み」でさえ、コンピュータのそれほど優秀ではないただの計算にも劣る程度でしかないこともわかる。要するに我々は「状況による」と言いながら全て漠然とした感覚のみで、「読んだ」気になっていただけなのだ。・・・そもそも、明確に（自分内言語でもいい）されていないものが、うまく機能するというのは楽観的すぎる思い上がりである。自分のわかっていないものを当てようとするとき、その当たり確率はせいぜい半々である。麻雀の読みにはいくつもの要因があり、それらの大半を半々の確率でしか当てていないなら、多くの場合結果は＋と－の要素が半々程度現れるので、結局「明確にわかっている部分までの範囲」だけが平均的に読めることになる。容赦なく本当のことを言えば、我々が「たくさんの要因を考えて」「経験から様々な情報を読んで」いたことは、莫大な量の＋と－とを長い時間をかけてただただ並べ続けるという不毛な作業にしか当たらなかったのだ。それが皮肉にも「わかっていることしか言えない」「複雑な現象を解明できない」はずの単純なコンピュータによって示されてしまったわけだ。明確に言語化されていないものは、強くないのだ。<BR>
<BR>
<BR>
上記の検証結果は、単に「残っている確率の高い牌の推定」でしかなかったが、MJ-0は「もっとも２枚以上残っている確率の高い牌（つまり持ち持ちのチェック）」なども簡単に計算できるし、同じ「確実に残っているだろう」という牌同士でも確率5％などの違いを見分けることができる。<BR>
実際、少しテストするだけで、自分が今まで「読んで」いた余り牌の計算がいかにでたらめであったかに気付かされる（少なくとも私は第一東風荘最強水準の雀士であるが）。<BR>
改良等の余地は別にあるとして、現段階でこのモデルは麻雀界で唯一の理論的な「他家必要メンツのモデル」であると想像され、（ここで余り牌読みが優れた成績を収めたように）様々な応用において有効利用できるものと思われる。例えば、他家が必要とするメンツを構成する牌のうち一つが、その他家の「当たり牌」であるから、他家のメンツを人間以上に精確に読むコンピュータは、他家の当たり牌を人間以上に精確に読めると考えられる。<BR>
<BR>
６）補記<BR>
MJ-0のルーチンはもっとも単純なバージョン0.01を用いた。ドラや現物だとか、最後に出た牌だのは全く考慮しておらず、上記モデルに基づいた牌の組み合わせ方の数え上げだけである。<BR>
思考に要する時間は0.2秒未満で、人間と違って時間に追われてミスすることはない。<BR>
このルーチンは後々データや他のパラメータなどを加えてバージョンアップできる。他の様々のルーチンは、このMJ-0のバージョンアップがなされるごとに、より有効に機能するようになる。<BR>
<BR>
<BR>
<B><U><FONT color="#0000FF">MJ-0　v0.01</FONT></U></B>　<BR>
このバージョンは細かいパラメータ指定はできません。染め手率やトイトイ率を使えません。他家の食い仕掛け率は１家分だけ指定できます。<BR>
上の検証に用いた、最も原始的なバージョンです。<BR>
使い勝手は死ぬほど悪いです。有用なアプリケーションとしてではなく、研究用・モデル検証用のツールですのでご了承ください。<BR>
<BR>
<B><U><FONT color="#0000FF">MJ-0　v0.02</FONT></U></B>　<BR>
「47型トイツ」の作成比率でカウントミスしていたので修正。<BR>
<BR>
<BR>
<FONT color="#FF0000"><SCRIPT type="text/javascript"><!--
google_ad_client = "pub-0849366231331886";
google_ad_width = 728;
google_ad_height = 90;
google_ad_format = "728x90_as";
google_ad_type = "text_image";
google_ad_channel ="";
//--></SCRIPT> <SCRIPT type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</SCRIPT> </FONT><BR>
<BR>
<BR>
<BR>
</P>
</BODY>
</HTML>
